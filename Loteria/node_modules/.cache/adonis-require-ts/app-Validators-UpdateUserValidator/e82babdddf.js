"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Validator_1 = global[Symbol.for('ioc.use')]("Adonis/Core/Validator");
class UpdateUserValidator {
    constructor(ctx) {
        this.ctx = ctx;
        this.refs = Validator_1.schema.refs({
            id: this.ctx.params.id,
        });
        this.schema = Validator_1.schema.create({
            cpf: Validator_1.schema.string.optional({ trim: true }, [
                Validator_1.rules.unique({ table: 'users', column: 'cpf', whereNot: { secure_id: this.refs.id } }),
                Validator_1.rules.regex(/^\d{3}.\d{3}.\d{3}-\d{2}$/),
                Validator_1.rules.required(),
            ]),
            name: Validator_1.schema.string.optional({ trim: true }, [
                Validator_1.rules.required(),
                Validator_1.rules.regex(/^[ a-zA-ZÀ-ÿ\u00f1\u00d1]*$/g),
            ]),
            email: Validator_1.schema.string.optional({ trim: true }, [
                Validator_1.rules.unique({
                    table: 'users',
                    column: 'email',
                    caseInsensitive: true,
                    whereNot: { secure_id: this.refs.id },
                }),
                Validator_1.rules.email(),
                Validator_1.rules.required(),
            ]),
        });
        this.messages = {};
    }
}
exports.default = UpdateUserValidator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVXBkYXRlVXNlclZhbGlkYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlVwZGF0ZVVzZXJWYWxpZGF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwyRUFBMEQ7QUFHMUQsTUFBcUIsbUJBQW1CO0lBQ3RDLFlBQXNCLEdBQXdCO1FBQXhCLFFBQUcsR0FBSCxHQUFHLENBQXFCO1FBRXZDLFNBQUksR0FBRyxrQkFBTSxDQUFDLElBQUksQ0FBQztZQUN4QixFQUFFLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRTtTQUN2QixDQUFDLENBQUE7UUFFSyxXQUFNLEdBQUcsa0JBQU0sQ0FBQyxNQUFNLENBQUM7WUFDNUIsR0FBRyxFQUFFLGtCQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBRTtnQkFDMUMsaUJBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztnQkFDdEYsaUJBQUssQ0FBQyxLQUFLLENBQUMsMkJBQTJCLENBQUM7Z0JBQ3hDLGlCQUFLLENBQUMsUUFBUSxFQUFFO2FBQ2pCLENBQUM7WUFDRixJQUFJLEVBQUUsa0JBQU0sQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFO2dCQUMzQyxpQkFBSyxDQUFDLFFBQVEsRUFBRTtnQkFDaEIsaUJBQUssQ0FBQyxLQUFLLENBQUMsOEJBQThCLENBQUM7YUFDNUMsQ0FBQztZQUNGLEtBQUssRUFBRSxrQkFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUU7Z0JBQzVDLGlCQUFLLENBQUMsTUFBTSxDQUFDO29CQUNYLEtBQUssRUFBRSxPQUFPO29CQUNkLE1BQU0sRUFBRSxPQUFPO29CQUNmLGVBQWUsRUFBRSxJQUFJO29CQUNyQixRQUFRLEVBQUUsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUU7aUJBQ3RDLENBQUM7Z0JBQ0YsaUJBQUssQ0FBQyxLQUFLLEVBQUU7Z0JBQ2IsaUJBQUssQ0FBQyxRQUFRLEVBQUU7YUFDakIsQ0FBQztTQUNILENBQUMsQ0FBQTtRQUVLLGFBQVEsR0FBRyxFQUFFLENBQUE7SUE1QjZCLENBQUM7Q0E2Qm5EO0FBOUJELHNDQThCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHNjaGVtYSwgcnVsZXMgfSBmcm9tICdAaW9jOkFkb25pcy9Db3JlL1ZhbGlkYXRvcidcbmltcG9ydCB0eXBlIHsgSHR0cENvbnRleHRDb250cmFjdCB9IGZyb20gJ0Bpb2M6QWRvbmlzL0NvcmUvSHR0cENvbnRleHQnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVwZGF0ZVVzZXJWYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgY3R4OiBIdHRwQ29udGV4dENvbnRyYWN0KSB7fVxuXG4gIHB1YmxpYyByZWZzID0gc2NoZW1hLnJlZnMoe1xuICAgIGlkOiB0aGlzLmN0eC5wYXJhbXMuaWQsXG4gIH0pXG5cbiAgcHVibGljIHNjaGVtYSA9IHNjaGVtYS5jcmVhdGUoe1xuICAgIGNwZjogc2NoZW1hLnN0cmluZy5vcHRpb25hbCh7IHRyaW06IHRydWUgfSwgW1xuICAgICAgcnVsZXMudW5pcXVlKHsgdGFibGU6ICd1c2VycycsIGNvbHVtbjogJ2NwZicsIHdoZXJlTm90OiB7IHNlY3VyZV9pZDogdGhpcy5yZWZzLmlkIH0gfSksXG4gICAgICBydWxlcy5yZWdleCgvXlxcZHszfS5cXGR7M30uXFxkezN9LVxcZHsyfSQvKSxcbiAgICAgIHJ1bGVzLnJlcXVpcmVkKCksXG4gICAgXSksXG4gICAgbmFtZTogc2NoZW1hLnN0cmluZy5vcHRpb25hbCh7IHRyaW06IHRydWUgfSwgW1xuICAgICAgcnVsZXMucmVxdWlyZWQoKSxcbiAgICAgIHJ1bGVzLnJlZ2V4KC9eWyBhLXpBLVrDgC3Dv1xcdTAwZjFcXHUwMGQxXSokL2cpLFxuICAgIF0pLFxuICAgIGVtYWlsOiBzY2hlbWEuc3RyaW5nLm9wdGlvbmFsKHsgdHJpbTogdHJ1ZSB9LCBbXG4gICAgICBydWxlcy51bmlxdWUoe1xuICAgICAgICB0YWJsZTogJ3VzZXJzJyxcbiAgICAgICAgY29sdW1uOiAnZW1haWwnLFxuICAgICAgICBjYXNlSW5zZW5zaXRpdmU6IHRydWUsXG4gICAgICAgIHdoZXJlTm90OiB7IHNlY3VyZV9pZDogdGhpcy5yZWZzLmlkIH0sXG4gICAgICB9KSxcbiAgICAgIHJ1bGVzLmVtYWlsKCksXG4gICAgICBydWxlcy5yZXF1aXJlZCgpLFxuICAgIF0pLFxuICB9KVxuXG4gIHB1YmxpYyBtZXNzYWdlcyA9IHt9XG59XG4iXX0=