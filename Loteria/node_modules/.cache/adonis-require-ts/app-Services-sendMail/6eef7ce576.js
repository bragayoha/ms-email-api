"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.sendMail = void 0;
const kafkajs_1 = require("kafkajs");
const kafka = new kafkajs_1.Kafka({
    clientId: 'api',
    brokers: ['localhost:9092'],
    retry: {
        initialRetryTime: 300,
        retries: 5,
    }
});
const producer = kafka.producer();
async function sendMail(user, subject, topic, info) {
    await producer.connect();
    const message = {
        user: user,
        subject: subject,
        info: info,
    };
    await producer.send({
        topic: topic,
        messages: [
            { value: JSON.stringify(message) }
        ]
    });
}
exports.sendMail = sendMail;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VuZE1haWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJzZW5kTWFpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDQSxxQ0FBK0I7QUFFL0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxlQUFLLENBQUM7SUFDdEIsUUFBUSxFQUFFLEtBQUs7SUFDZixPQUFPLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQztJQUMzQixLQUFLLEVBQUU7UUFDTCxnQkFBZ0IsRUFBRSxHQUFHO1FBQ3JCLE9BQU8sRUFBRSxDQUFDO0tBQ1g7Q0FDRixDQUFDLENBQUE7QUFFRixNQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUE7QUFFMUIsS0FBSyxVQUFVLFFBQVEsQ0FBQyxJQUFVLEVBQUUsT0FBZSxFQUFFLEtBQWEsRUFBRSxJQUFTO0lBQ2xGLE1BQU0sUUFBUSxDQUFDLE9BQU8sRUFBRSxDQUFBO0lBRXhCLE1BQU0sT0FBTyxHQUFHO1FBQ2QsSUFBSSxFQUFFLElBQUk7UUFDVixPQUFPLEVBQUUsT0FBTztRQUNoQixJQUFJLEVBQUUsSUFBSTtLQUNYLENBQUE7SUFFRCxNQUFNLFFBQVEsQ0FBQyxJQUFJLENBQUM7UUFDbEIsS0FBSyxFQUFFLEtBQUs7UUFDWixRQUFRLEVBQUU7WUFDUixFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxFQUFDO1NBQ2xDO0tBQ0YsQ0FBQyxDQUFBO0FBQ0osQ0FBQztBQWZELDRCQWVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVzZXIgZnJvbSAnQXBwL01vZGVscy9Vc2VyJ1xuaW1wb3J0IHsgS2Fma2EgfSBmcm9tICdrYWZrYWpzJ1xuXG5jb25zdCBrYWZrYSA9IG5ldyBLYWZrYSh7XG4gIGNsaWVudElkOiAnYXBpJyxcbiAgYnJva2VyczogWydsb2NhbGhvc3Q6OTA5MiddLFxuICByZXRyeToge1xuICAgIGluaXRpYWxSZXRyeVRpbWU6IDMwMCxcbiAgICByZXRyaWVzOiA1LFxuICB9XG59KVxuXG5jb25zdCBwcm9kdWNlciA9IGthZmthLnByb2R1Y2VyKClcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRNYWlsKHVzZXI6IFVzZXIsIHN1YmplY3Q6IHN0cmluZywgdG9waWM6IHN0cmluZywgaW5mbz86IHt9KTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IHByb2R1Y2VyLmNvbm5lY3QoKVxuXG4gIGNvbnN0IG1lc3NhZ2UgPSB7XG4gICAgdXNlcjogdXNlcixcbiAgICBzdWJqZWN0OiBzdWJqZWN0LFxuICAgIGluZm86IGluZm8sXG4gIH1cblxuICBhd2FpdCBwcm9kdWNlci5zZW5kKHtcbiAgICB0b3BpYzogdG9waWMsXG4gICAgbWVzc2FnZXM6IFtcbiAgICAgIHsgdmFsdWU6IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpfVxuICAgIF1cbiAgfSlcbn1cbiJdfQ==